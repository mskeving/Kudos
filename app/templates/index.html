<html>
	<head>



		<div class="title">
			{% if title %}
			<title>{{title}} - Kudos </title>
			{% else %}
			<title>Kudos</title>
			{% endif %}
		</div>
	</head>
	<body>
		{% extends "base.html" %}
		{% block content %}
	

		<div name="header">
		<h3 id="header" name="home_title" style="padding: 5px">Kudos!</h3>
		</div>



		
			<!-- Submit new Kudos -->
			<form action="/editpost" method="POST" name="add">
				<!-- inclide csrf token in every form for security -->
				{{ new_post.csrf_token }} 

				{% for error in new_post.errors.post_body %}



				<span style="color:red;">[{{error}}]</span> 
				{% endfor %}<br>
				<div class="row">
					<div class="col-lg-6">
						<div class ="submit-kudos" style="padding: 20px; width: 476px; height: 200px;">
		    				<div class="input-group">
		    					<span class="form-control">{{ new_post.post_body (style="width: 440px; ") }} </span>
		    				</div>
		    				<div class="tags" id="tagsinput_tagsinput" name="tags_div" style="width: 476px; padding: 5px;">
								<input type="text" class="tag_input" id="tag_input" name="tag_input" value placeholder="tags" style="width: 450px; align: center; padding: 5px"/>
							</div>

			    			<button type="submit" class="btn btn-large btn-block btn-primary" name="new_post_btn" value="submit" style="padding: 5px 0px; width: 90px; height: 30px;"> Submit </button>
									<!-- {{ new_post.post_submit_btn(value="submit post")}} -->

						</div>
					</div>
				</div>
			</form>

		<!-- Display all posts -->
		{% for post in posts %}

			<div class="display-post" style="padding: 5px 5px 5px {{ 30 * post.get('indent') + 20 }}px;">
				<img src={{ user.photo }} height='42' width='42'>


				<i> <a href="{{ url_for('user', nickname=user.nickname) }}">{{post.get('nickname')}} </a> says:</i><br>
				{{post.get('body')}}
			</div>

			<form action="/newreply" method="POST">
				{{ new_post.csrf_token }}
				<div style="padding: 5px 5px 5px {{ 30 * post.get('indent') + 20 }}px; width: 515px">
					<div name="reply-body">
						{{reply_form.reply_body (style="width: 500px; height: 35px;")}}

			
						<div class="tags" id="tagsinput_tagsinput" name="tags_div" style="width: 476px; padding: 5px;">
							<input type="text" class="tag_input" name="tag_input" value placeholder="tags" style="width: 450px; align: center; padding: 5px"/>
						</div>


						<button type="submit" class="btn btn-large btn-block btn-primary" name="new_reply_btn" value="submit" style="padding: 5px 0px; width: 90px; height: 30px; float: right"> reply </button>

					</div>

				</div>
				<!-- Associate text box with specific post -->
				{{ reply_form.hidden_post_id(value=post.get('post_id')) }}

			</form>
		{% endfor %}

	
		<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.5.2/jquery.min.js"></script>
		<script type='text/javascript' src='https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.13/jquery-ui.min.js'></script>
		<link rel="stylesheet" type="text/css" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.13/themes/start/jquery-ui.css" />
		<script type="text/javascript" src="/static/js/jquery.tagsinput.js"></script>
		<link rel="stylesheet" type="text/css" href="http://xoxco.com/projects/code/tagsinput/jquery.tagsinput.css" />

		<script type="text/javascript">
			$(document).ready(function(){

			});


			function onAddTag(tag) {
				//add link to tag 
				console.log("added tag: " + tag);
				
			}
			function onRemoveTag(tag) {
				console.log("Removed a tag: " + tag);
			}

			function onChangeTag(input,tag) {
				console.log("Changed a tag: " + tag);
			}

			$(function() {

				var tag_words = {{tags|safe}}; //safe: tell flask that this input is okay
				var tag_ids = {{tag_ids|safe}}
				

				$('.tag_input').tagsInput({
					width: 'auto',
					height: '30px',
					autocomplete_list: tag_words, 
					tag_ids:  tag_ids
				});
				

			});

		</script>
		{% endblock %}

		
	</body>
</html>
